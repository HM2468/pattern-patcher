-# app/views/scan_runs/index.html.haml

%div{ class: "h-[85vh] overflow-hidden" }
  %div#scan_runs_panel{
    class: "flex flex-col h-full overflow-hidden rounded-2xl bg-white shadow-sm"
  }

    -# ===== Fixed Header (NOT scroll) =====
    %div{ class: "text-gray-600 border-b border-gray-200" }
      %div{ class: "px-6 py-3 flex items-center justify-between gap-3" }
        %div{ class: "flex flex-col items-start text-left leading-tight min-w-0" }
          %div{ class: "text-lg font-semibold text-gray-900" }
            = "Scan Runs - #{@current_repository.name}"
        %div{ class: "shrink-0" }
          = link_to repository_files_path(repository_id: @selected_id),
            class: "icon-button",
            data: tooltip_data(tip: "Back") do
            = svg_icon("arrow-uturn-left", class_name: "w-6 h-6")

    -# ===== Scroll area: ONLY body scrolls =====
    %div#scan_runs_body_scroll{
      class: "pp-scroll-gutter-stable flex-1 overflow-y-auto",
      data: { controller: "scan-runs", scan_runs_channel_value: "ScanRunsChannel" }
    }
      %div{ class: "px-6 py-4 space-y-3" }
        - if @scan_runs.blank?
          %div{ class: "rounded-xl bg-gray-50 p-6 text-gray-600" } No scan runs found.
        - else
          - @scan_runs.each do |sr|
            = render partial: "scan_run", locals: { scan_run: sr, progress: @progress_by_id[sr.id] }

    -# ===== Fixed Footer Pagination =====
    %div{ class: "repo-files-pagination sticky bottom-0 z-10 bg-white border-t border-gray-200" }
      %div{ class: "px-6 py-3" }
        = render "shared/pagination",
          collection: @scan_runs,
          options: { repository_id: @selected_id }.compact