-# app/views/lexical_patterns/index.html.haml
-# Lexical Patterns index
-# Shows: Name / Type / Enabled toggle / Priority / Actions
-# Turbo delete (fill-the-gap): tbody/pagination/empty are wrapped with stable DOM ids

%main{ class: "mx-auto max-w-6xl px-6 py-8 space-y-6" }
  %div{ class: "flex items-center justify-between gap-4" }
    %div
      %h2{ class: "text-2xl font-semibold tracking-tight" } Lexical Patterns
      %p{ class: "mt-1 text-sm text-gray-600" }
        Patterns are executed in priority order. Lower priority number runs first.

    %div{ class: "flex gap-2" }
      = link_to "New Pattern", new_lexical_pattern_path,
        class: "button-primary"
      -# = link_to new_lexical_pattern_path,
      -#   class: "icon-button",
      -#   data: { controller: "tooltip", tooltip_text_value: "New Pattern", tooltip_placement_value: "bottom" } do
      -#   = svg_icon("plus", class_name: "w-6 h-6")

  .rounded-2xl.bg-white.shadow-sm.overflow-hidden
    %table{ class: "w-full text-sm" }
      %thead{ class: "bg-indigo-100 text-gray-600" }
        %tr
          %th{ class: "px-4 py-3 text-left font-medium" } Name
          %th{ class: "px-4 py-3 text-left font-medium" } Type
          %th{ class: "px-4 py-3 text-left font-medium" } Enabled
          %th{ class: "pl-17 pr-4 py-3 text-left font-medium" } Actions

      -# IMPORTANT: stable tbody id so Turbo can replace it to fill the gap after delete
      %tbody{ id: "lexical_patterns_tbody", class: "divide-y divide-gray-300" }
        - @lexical_patterns.each do |pattern|
          = render "row", pattern: pattern

  -# IMPORTANT: stable empty state container (Turbo replace)
  %div{ id: "lexical_patterns_empty_state" }
    - if @lexical_patterns.empty?
      .rounded-2xl.bg-gray-50.p-8.shadow-sm
        %div{ class: "text-sm text-gray-600" }
          No patterns yet. Create your first pattern to start scanning.

  -# IMPORTANT: stable pagination container (Turbo replace)
  %div{ id: "lexical_patterns_pagination" }
    - if @lexical_patterns.any? && @lexical_patterns.total_pages > 1
      = render "shared/pagination", collection: @lexical_patterns