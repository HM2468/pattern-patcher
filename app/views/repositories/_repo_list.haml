-# app/views/repositories/_repo_list.html.haml

%div{ class: "p-3" }
  %h1{ class: "text-xl font-semibold" } Repositories
  %div{ class: "mt-1" }
    = link_to "New repository", new_repository_path,
      class: "px-3 py-2 rounded-lg border bg-white hover:bg-gray-50 text-sm"

- if @repositories.empty?
  %div{ class: "p-3" }
    %div{ class: "font-semibold mb-2" } No repositories yet
    %div{ class: "text-sm text-gray-700 mb-4" }
      Create one to import files from a local folder.
    = link_to "Create your first repository", new_repository_path,
      class: "inline-flex px-3 py-2 rounded-lg border bg-white hover:bg-gray-50 text-sm"
- else
  %div{ class: "divide-gray-300 flex-grow overflow-y-auto" }
    - @repositories.each do |repo|
      = link_to repositories_path(repository_id: repo.id),
        class: "block p-3 hover:bg-gray-50 #{params[:repository_id] == repo.id.to_s || (params[:repository_id].nil? && repo == @repositories.first) ? 'bg-gray-50' : ''}" do
        %div{ class: "flex items-start gap-3" }
          -# folder icon (simple svg)
          %div{ class: "w-10 h-10 rounded-lg border bg-white flex items-center justify-center shrink-0" }
            %svg{ width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", xmlns: "http://www.w3.org/2000/svg" }
              %path{ d: "M3 6a2 2 0 0 1 2-2h5l2 2h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6z", stroke: "currentColor", stroke_width: "1.6" }
          %div{ class: "min-w-0" }
            %div{ class: "font-semibold text-sm truncate" }= repo.name
            %div{ class: "text-xs text-gray-600 truncate" }= repo.root_path
            %div{ class: "text-xs text-gray-600 mt-1" }
              %span{ class: "inline-block px-2 py-0.5 rounded border bg-gray-50" }= repo.status
              %span{ class: "inline-block px-2 py-0.5 rounded border bg-gray-50 ml-1" }= repo.permitted_ext

          %div{ class: "ml-auto flex gap-2" }
            = button_to "Import",
              import_repository_path(repo),
              method: :post,
              form: { class: "inline" },
              class: "text-xs px-2 py-1 rounded border bg-white hover:bg-gray-50"